GPU 0: Tesla V100-SXM2-32GB (UUID: GPU-e1d36251-fc5a-141f-2f2c-f9ca82b2bdb9)
Allocate GPU cards : 0
üö®  [0;38;5;196mGPU mode requested. Make sure you have Cuda/CuDNN installed[0m
üéÉ  [0;38;5;208mActivating conda environment 'adversarial-gpu' on local platform[0m
pwd:  /hpcfs/bes/mlgpu/gang/adversarial
[38;2;74;176;245m[1mProfile[0m ‚è±  Starting [1m@main[0m
[38;2;74;176;245m[1mProfile[0m ‚è±  ¬∑¬∑ Starting [1mInitialisation[0m
[38;2;74;176;245m[1mProfile[0m ‚è±  ¬∑¬∑¬∑¬∑ Starting [1m@initialise[0m
[38;2;74;176;245m[1mProfile[0m ‚è±  ¬∑¬∑¬∑¬∑ Time elapsed in [1m@initialise[0m: .............................. [1m1.3s[0m
[38;2;74;176;245m[1mProfile[0m ‚è±  ¬∑¬∑¬∑¬∑ Starting [1m@initialise_backend[0m
[38;2;74;176;245m[1mProfile[0m ‚è±  ¬∑¬∑¬∑¬∑¬∑¬∑ Starting [1m@configure_tensorflow[0m
[38;2;74;176;245m[1mProfile[0m ‚è±  ¬∑¬∑¬∑¬∑¬∑¬∑ Time elapsed in [1m@configure_tensorflow[0m: ................ [1m529.3s[0m
[38;2;74;176;245m[1mProfile[0m ‚è±  ¬∑¬∑¬∑¬∑ Time elapsed in [1m@initialise_backend[0m: .................... [1m532.5s[0m
{'config': './configs/default_disco_lambda50.json',
 'devices': 1,
 'folds': 3,
 'gpu': True,
 'input': './input/',
 'jobname': '',
 'mode': 'gpu',
 'optimise_adversarial': False,
 'optimise_classifier': False,
 'output': './output/',
 'patches': [],
 'tensorboard': False,
 'theano': False,
 'train': False,
 'train_adversarial': False,
 'train_classifier': True,
 'verbose': True}
{u'classifier': {u'compile': {u'loss': None,
                              u'optimizer': <keras.optimizers.Adam object at 0x2af873c1b9d0>},
                 u'fit': {u'batch_size': 2048,
                          u'epochs': 200,
                          u'shuffle': True,
                          'verbose': 2},
                 u'lambda_reg': 50.0,
                 u'model': {u'architecture': [{}, {}, {}],
                            u'default': {u'activation': u'relu',
                                         u'batchnorm': True,
                                         u'units': 64}}}}
  TensorFlow version: 1.4.1
[38;2;74;176;245m[1mProfile[0m ‚è±  ¬∑¬∑ Time elapsed in [1mInitialisation[0m: ........................... [1m534.5s[0m
[38;2;74;176;245m[1mProfile[0m ‚è±  ¬∑¬∑ Starting [1m@load_data[0m
[38;2;74;176;245m[1mProfile[0m ‚è±  ¬∑¬∑ Time elapsed in [1m@load_data[0m: ............................... [1m377.5s[0m
lambda_reg =  50.0
lambda_str =  50
[38;2;74;176;245m[1mProfile[0m ‚è±  ¬∑¬∑ Starting [1m@get_decorrelation_variables[0m
[38;2;74;176;245m[1mProfile[0m ‚è±  ¬∑¬∑ Time elapsed in [1m@get_decorrelation_variables[0m: ............... [1m2.3s[0m
[38;2;74;176;245m[1mProfile[0m ‚è±  ¬∑¬∑ Starting [1mClassifier-only fit, cross-validation[0m
[38;2;74;176;245m[1mProfile[0m ‚è±  ¬∑¬∑ Time elapsed in [1mClassifier-only fit, cross-validation[0m: ...... [1m0.1s[0m
[38;2;74;176;245m[1mProfile[0m ‚è±  ¬∑¬∑ Starting [1mClassifier-only fit, full[0m
y_true_tmp =  Tensor("classifier/output_target:0", shape=(?, ?), dtype=float32)
X_in shape:  (?, 1)
Y_in shape:  (?, 1)
W_in shape:  (?, 1)
var_1 shape:  (?,)
var_2 shape:  (?,)
Main X shape: (291138, 10)
Main Y shape: (291138, 3)
Main W shape: (291138,)
Train on 291138 samples, validate on 290701 samples
Epoch 1/200
 - 319s - loss: 0.8573 - val_loss: 0.7024
Epoch 2/200
 - 2s - loss: 0.6591 - val_loss: 0.6141
Epoch 3/200
 - 2s - loss: 0.5918 - val_loss: 0.5732
Epoch 4/200
 - 2s - loss: 0.5453 - val_loss: 0.5419
Epoch 5/200
 - 2s - loss: 0.5179 - val_loss: 0.5213
Epoch 6/200
 - 2s - loss: 0.5076 - val_loss: 0.5066
Epoch 7/200
 - 2s - loss: 0.4924 - val_loss: 0.4971
Epoch 8/200
 - 2s - loss: 0.4802 - val_loss: 0.4879
Epoch 9/200
 - 2s - loss: 0.4802 - val_loss: 0.4946
Epoch 10/200
 - 2s - loss: 0.4679 - val_loss: 0.4872
Epoch 11/200
 - 2s - loss: 0.4699 - val_loss: 0.4831
Epoch 12/200
 - 2s - loss: 0.4645 - val_loss: 0.4882
Epoch 13/200
 - 2s - loss: 0.4603 - val_loss: 0.4691
Epoch 14/200
 - 2s - loss: 0.4655 - val_loss: 0.4685
Epoch 15/200
 - 2s - loss: 0.4595 - val_loss: 0.4632
Epoch 16/200
 - 2s - loss: 0.4438 - val_loss: 0.4610
Epoch 17/200
 - 2s - loss: 0.4489 - val_loss: 0.4594
Epoch 18/200
 - 2s - loss: 0.4506 - val_loss: 0.4637
Epoch 19/200
 - 2s - loss: 0.4522 - val_loss: 0.4562
Epoch 20/200
 - 2s - loss: 0.4444 - val_loss: 0.4555
Epoch 21/200
 - 2s - loss: 0.4475 - val_loss: 0.4560
Epoch 22/200
 - 2s - loss: 0.4443 - val_loss: 0.4532
Epoch 23/200
 - 2s - loss: 0.4392 - val_loss: 0.4514
Epoch 24/200
 - 2s - loss: 0.4402 - val_loss: 0.4501
Epoch 25/200
 - 2s - loss: 0.4425 - val_loss: 0.4499
Epoch 26/200
 - 2s - loss: 0.4367 - val_loss: 0.4560
Epoch 27/200
 - 2s - loss: 0.4354 - val_loss: 0.4482
Epoch 28/200
 - 2s - loss: 0.4383 - val_loss: 0.4476
Epoch 29/200
 - 2s - loss: 0.4448 - val_loss: 0.4469
Epoch 30/200
 - 2s - loss: 0.4364 - val_loss: 0.4456
Epoch 31/200
 - 2s - loss: 0.4334 - val_loss: 0.4489
Epoch 32/200
 - 2s - loss: 0.4336 - val_loss: 0.4445
Epoch 33/200
 - 2s - loss: 0.4431 - val_loss: 0.4451
Epoch 34/200
 - 2s - loss: 0.4344 - val_loss: 0.4431
Epoch 35/200
 - 2s - loss: 0.4288 - val_loss: 0.4421
Epoch 36/200
 - 2s - loss: 0.4350 - val_loss: 0.4421
Epoch 37/200
 - 2s - loss: 0.4301 - val_loss: 0.4413
Epoch 38/200
 - 2s - loss: 0.4249 - val_loss: 0.4421
Epoch 39/200
 - 2s - loss: 0.4273 - val_loss: 0.4406
Epoch 40/200
 - 2s - loss: 0.4256 - val_loss: 0.4405
Epoch 41/200
 - 2s - loss: 0.4272 - val_loss: 0.4410
Epoch 42/200
 - 2s - loss: 0.4284 - val_loss: 0.4389
Epoch 43/200
 - 2s - loss: 0.4270 - val_loss: 0.4386
Epoch 44/200
 - 2s - loss: 0.4276 - val_loss: 0.4382
Epoch 45/200
 - 2s - loss: 0.4300 - val_loss: 0.4384
Epoch 46/200
 - 2s - loss: 0.4289 - val_loss: 0.4377
Epoch 47/200
 - 2s - loss: 0.4293 - val_loss: 0.4379
Epoch 48/200
 - 2s - loss: 0.4228 - val_loss: 0.4370
Epoch 49/200
 - 2s - loss: 0.4321 - val_loss: 0.4363
Epoch 50/200
 - 2s - loss: 0.4278 - val_loss: 0.4371
Epoch 51/200
 - 2s - loss: 0.4290 - val_loss: 0.4363
Epoch 52/200
 - 2s - loss: 0.4276 - val_loss: 0.4358
Epoch 53/200
 - 2s - loss: 0.4271 - val_loss: 0.4366
Epoch 54/200
 - 2s - loss: 0.4260 - val_loss: 0.4346
Epoch 55/200
 - 2s - loss: 0.4304 - val_loss: 0.4356
Epoch 56/200
 - 2s - loss: 0.4251 - val_loss: 0.4350
Epoch 57/200
 - 2s - loss: 0.4235 - val_loss: 0.4351
Epoch 58/200
 - 2s - loss: 0.4258 - val_loss: 0.4375
Epoch 59/200
 - 2s - loss: 0.4221 - val_loss: 0.4336
Epoch 60/200
 - 2s - loss: 0.4225 - val_loss: 0.4358
Epoch 61/200
 - 2s - loss: 0.4178 - val_loss: 0.4335
Epoch 62/200
 - 2s - loss: 0.4238 - val_loss: 0.4332
Epoch 63/200
 - 2s - loss: 0.4201 - val_loss: 0.4329
Epoch 64/200
 - 2s - loss: 0.4269 - val_loss: 0.4334
Epoch 65/200
 - 2s - loss: 0.4164 - val_loss: 0.4325
Epoch 66/200
 - 2s - loss: 0.4249 - val_loss: 0.4327
Epoch 67/200
 - 2s - loss: 0.4255 - val_loss: 0.4331
Epoch 68/200
 - 2s - loss: 0.4183 - val_loss: 0.4319
Epoch 69/200
 - 2s - loss: 0.4303 - val_loss: 0.4318
Epoch 70/200
 - 2s - loss: 0.4215 - val_loss: 0.4320
Epoch 71/200
 - 2s - loss: 0.4226 - val_loss: 0.4312
Epoch 72/200
 - 2s - loss: 0.4203 - val_loss: 0.4317
Epoch 73/200
 - 2s - loss: 0.4301 - val_loss: 0.4316
Epoch 74/200
 - 2s - loss: 0.4253 - val_loss: 0.4323
Epoch 75/200
 - 2s - loss: 0.4218 - val_loss: 0.4309
Epoch 76/200
 - 2s - loss: 0.4254 - val_loss: 0.4328
Epoch 77/200
 - 2s - loss: 0.4200 - val_loss: 0.4303
Epoch 78/200
 - 2s - loss: 0.4198 - val_loss: 0.4327
Epoch 79/200
 - 2s - loss: 0.4204 - val_loss: 0.4303
Epoch 80/200
 - 2s - loss: 0.4202 - val_loss: 0.4308
Epoch 81/200
 - 2s - loss: 0.4188 - val_loss: 0.4300
Epoch 82/200
 - 2s - loss: 0.4190 - val_loss: 0.4301
Epoch 83/200
 - 2s - loss: 0.4186 - val_loss: 0.4299
Epoch 84/200
 - 2s - loss: 0.4223 - val_loss: 0.4299
Epoch 85/200
 - 2s - loss: 0.4165 - val_loss: 0.4292
Epoch 86/200
 - 2s - loss: 0.4199 - val_loss: 0.4288
Epoch 87/200
 - 2s - loss: 0.4259 - val_loss: 0.4303
Epoch 88/200
 - 2s - loss: 0.4213 - val_loss: 0.4290
Epoch 89/200
 - 2s - loss: 0.4172 - val_loss: 0.4284
Epoch 90/200
 - 2s - loss: 0.4298 - val_loss: 0.4285
Epoch 91/200
 - 2s - loss: 0.4182 - val_loss: 0.4285
Epoch 92/200
 - 2s - loss: 0.4168 - val_loss: 0.4298
Epoch 93/200
 - 2s - loss: 0.4206 - val_loss: 0.4282
Epoch 94/200
 - 2s - loss: 0.4182 - val_loss: 0.4284
Epoch 95/200
 - 2s - loss: 0.4202 - val_loss: 0.4284
Epoch 96/200
 - 2s - loss: 0.4167 - val_loss: 0.4288
Epoch 97/200
 - 2s - loss: 0.4250 - val_loss: 0.4283
Epoch 98/200
 - 2s - loss: 0.4209 - val_loss: 0.4285
Epoch 99/200
 - 2s - loss: 0.4166 - val_loss: 0.4278
Epoch 100/200
 - 2s - loss: 0.4191 - val_loss: 0.4274
Epoch 101/200
 - 2s - loss: 0.4145 - val_loss: 0.4280
Epoch 102/200
 - 2s - loss: 0.4200 - val_loss: 0.4272
Epoch 103/200
 - 2s - loss: 0.4222 - val_loss: 0.4272
Epoch 104/200
 - 2s - loss: 0.4158 - val_loss: 0.4277
Epoch 105/200
 - 2s - loss: 0.4094 - val_loss: 0.4272
Epoch 106/200
 - 2s - loss: 0.4187 - val_loss: 0.4270
Epoch 107/200
 - 2s - loss: 0.4229 - val_loss: 0.4266
Epoch 108/200
 - 2s - loss: 0.4213 - val_loss: 0.4271
Epoch 109/200
 - 2s - loss: 0.4209 - val_loss: 0.4269
Epoch 110/200
 - 2s - loss: 0.4108 - val_loss: 0.4266
Epoch 111/200
 - 2s - loss: 0.4248 - val_loss: 0.4265
Epoch 112/200
 - 2s - loss: 0.4113 - val_loss: 0.4264
Epoch 113/200
 - 2s - loss: 0.4192 - val_loss: 0.4272
Epoch 114/200
 - 2s - loss: 0.4133 - val_loss: 0.4266
Epoch 115/200
 - 2s - loss: 0.4195 - val_loss: 0.4264
Epoch 116/200
 - 2s - loss: 0.4198 - val_loss: 0.4259
Epoch 117/200
 - 2s - loss: 0.4170 - val_loss: 0.4261
Epoch 118/200
 - 2s - loss: 0.4144 - val_loss: 0.4257
Epoch 119/200
 - 2s - loss: 0.4138 - val_loss: 0.4258
Epoch 120/200
 - 2s - loss: 0.4158 - val_loss: 0.4259
Epoch 121/200
 - 2s - loss: 0.4174 - val_loss: 0.4258
Epoch 122/200
 - 2s - loss: 0.4191 - val_loss: 0.4257
Epoch 123/200
 - 2s - loss: 0.4163 - val_loss: 0.4254
Epoch 124/200
 - 2s - loss: 0.4151 - val_loss: 0.4263
Epoch 125/200
 - 2s - loss: 0.4213 - val_loss: 0.4253
Epoch 126/200
 - 2s - loss: 0.4188 - val_loss: 0.4251
Epoch 127/200
 - 2s - loss: 0.4200 - val_loss: 0.4251
Epoch 128/200
 - 2s - loss: 0.4179 - val_loss: 0.4250
Epoch 129/200
 - 2s - loss: 0.4134 - val_loss: 0.4249
Epoch 130/200
 - 2s - loss: 0.4174 - val_loss: 0.4249
Epoch 131/200
 - 2s - loss: 0.4172 - val_loss: 0.4260
Epoch 132/200
 - 2s - loss: 0.4145 - val_loss: 0.4249
Epoch 133/200
 - 2s - loss: 0.4198 - val_loss: 0.4244
Epoch 134/200
 - 2s - loss: 0.4170 - val_loss: 0.4245
Epoch 135/200
 - 2s - loss: 0.4166 - val_loss: 0.4246
Epoch 136/200
 - 2s - loss: 0.4160 - val_loss: 0.4245
Epoch 137/200
 - 2s - loss: 0.4175 - val_loss: 0.4249
Epoch 138/200
 - 2s - loss: 0.4184 - val_loss: 0.4243
Epoch 139/200
 - 2s - loss: 0.4212 - val_loss: 0.4245
Epoch 140/200
 - 2s - loss: 0.4086 - val_loss: 0.4243
Epoch 141/200
 - 2s - loss: 0.4132 - val_loss: 0.4244
Epoch 142/200
 - 2s - loss: 0.4144 - val_loss: 0.4248
Epoch 143/200
 - 2s - loss: 0.4179 - val_loss: 0.4243
Epoch 144/200
 - 2s - loss: 0.4133 - val_loss: 0.4240
Epoch 145/200
 - 2s - loss: 0.4120 - val_loss: 0.4239
Epoch 146/200
 - 2s - loss: 0.4138 - val_loss: 0.4238
Epoch 147/200
 - 2s - loss: 0.4160 - val_loss: 0.4241
Epoch 148/200
 - 2s - loss: 0.4141 - val_loss: 0.4240
Epoch 149/200
 - 2s - loss: 0.4142 - val_loss: 0.4236
Epoch 150/200
 - 2s - loss: 0.4168 - val_loss: 0.4234
Epoch 151/200
 - 2s - loss: 0.4137 - val_loss: 0.4236
Epoch 152/200
 - 2s - loss: 0.4186 - val_loss: 0.4235
Epoch 153/200
 - 2s - loss: 0.4119 - val_loss: 0.4235
Epoch 154/200
 - 2s - loss: 0.4081 - val_loss: 0.4233
Epoch 155/200
 - 2s - loss: 0.4167 - val_loss: 0.4235
Epoch 156/200
 - 2s - loss: 0.4106 - val_loss: 0.4232
Epoch 157/200
 - 2s - loss: 0.4144 - val_loss: 0.4230
Epoch 158/200
 - 2s - loss: 0.4177 - val_loss: 0.4233
Epoch 159/200
 - 2s - loss: 0.4168 - val_loss: 0.4231
Epoch 160/200
 - 2s - loss: 0.4098 - val_loss: 0.4235
Epoch 161/200
 - 2s - loss: 0.4140 - val_loss: 0.4229
Epoch 162/200
 - 2s - loss: 0.4218 - val_loss: 0.4229
Epoch 163/200
 - 2s - loss: 0.4112 - val_loss: 0.4228
Epoch 164/200
 - 2s - loss: 0.4119 - val_loss: 0.4229
Epoch 165/200
 - 2s - loss: 0.4089 - val_loss: 0.4227
Epoch 166/200
 - 2s - loss: 0.4189 - val_loss: 0.4226
Epoch 167/200
 - 2s - loss: 0.4170 - val_loss: 0.4227
Epoch 168/200
 - 2s - loss: 0.4102 - val_loss: 0.4228
Epoch 169/200
 - 2s - loss: 0.4120 - val_loss: 0.4226
Epoch 170/200
 - 2s - loss: 0.4156 - val_loss: 0.4225
Epoch 171/200
 - 2s - loss: 0.4103 - val_loss: 0.4227
Epoch 172/200
 - 2s - loss: 0.4142 - val_loss: 0.4223
Epoch 173/200
 - 2s - loss: 0.4187 - val_loss: 0.4223
Epoch 174/200
 - 2s - loss: 0.4133 - val_loss: 0.4222
Epoch 175/200
 - 2s - loss: 0.4098 - val_loss: 0.4222
Epoch 176/200
 - 2s - loss: 0.4104 - val_loss: 0.4220
Epoch 177/200
 - 2s - loss: 0.4200 - val_loss: 0.4220
Epoch 178/200
 - 2s - loss: 0.4078 - val_loss: 0.4219
Epoch 179/200
 - 2s - loss: 0.4137 - val_loss: 0.4222
Epoch 180/200
 - 2s - loss: 0.4134 - val_loss: 0.4218
Epoch 181/200
 - 2s - loss: 0.4167 - val_loss: 0.4220
Epoch 182/200
 - 2s - loss: 0.4135 - val_loss: 0.4218
Epoch 183/200
 - 2s - loss: 0.4090 - val_loss: 0.4219
Epoch 184/200
 - 2s - loss: 0.4077 - val_loss: 0.4217
Epoch 185/200
 - 2s - loss: 0.4156 - val_loss: 0.4216
Epoch 186/200
 - 2s - loss: 0.4127 - val_loss: 0.4217
Epoch 187/200
 - 2s - loss: 0.4143 - val_loss: 0.4217
Epoch 188/200
 - 2s - loss: 0.4077 - val_loss: 0.4215
Epoch 189/200
 - 2s - loss: 0.4150 - val_loss: 0.4216
Epoch 190/200
 - 2s - loss: 0.4080 - val_loss: 0.4215
Epoch 191/200
 - 2s - loss: 0.4177 - val_loss: 0.4215
Epoch 192/200
 - 2s - loss: 0.4107 - val_loss: 0.4217
Epoch 193/200
 - 2s - loss: 0.4132 - val_loss: 0.4216
Epoch 194/200
 - 2s - loss: 0.4124 - val_loss: 0.4214
Epoch 195/200
 - 2s - loss: 0.4180 - val_loss: 0.4213
Epoch 196/200
 - 2s - loss: 0.4138 - val_loss: 0.4214
Epoch 197/200
 - 2s - loss: 0.4178 - val_loss: 0.4214
Epoch 198/200
 - 2s - loss: 0.4132 - val_loss: 0.4212
Epoch 199/200
 - 2s - loss: 0.4131 - val_loss: 0.4212
Epoch 200/200
 - 2s - loss: 0.4101 - val_loss: 0.4212
[38;2;74;176;245m[1mProfile[0m ‚è±  ¬∑¬∑ Time elapsed in [1mClassifier-only fit, full[0m: ................ [1m853.3s[0m
[38;2;74;176;245m[1mProfile[0m ‚è±  Time elapsed in [1m@main[0m: ...................................... [1m1768.4s[0m
